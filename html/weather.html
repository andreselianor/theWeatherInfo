<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset='utf-8'>
  <meta http-equiv='X-UA-Compatible' content='IE=edge'>
  <title>Weather Forecast | Weather Ecosystems</title>
  <meta name='viewport' content='width=device-width, initial-scale=1'>
  <link rel='icon' type='icon' href='../media/icons/icon.svg'>
  <link rel='stylesheet' type='text/css' media='screen' href='../css/weather.css'>
  <link rel='stylesheet' type='text/css' media='screen' href='../css/ecosistem.css'>
  <script src='../js/weather.js' defer></script>
  <script src='../js/header.js' defer></script>
  <script src='../js/footer.js' defer></script>
  <script src='../js/movement.js' defer></script>
</head>

<body>
  <my-header></my-header>

  <main>
    <div class="ecosistems">
      <button class="arrow-btn">&lt;</button>
      <button class="circle-btn" style="--c1:#ff6b6b; --c2:#feca57; --c3:#1dd1a1; --c4:#5f27cd;"
        title="Turist in Alicante" onclick="createTuristCards()"></button>
      <button class="circle-btn" style="--c1:#ff9f43; --c2:#ee5253; --c3:#54a0ff; --c4:#00d2d3;"
        title="European Capitals" onclick="createCapitalsCards()"></button>
      <button class="circle-btn" style="--c1:#1dd1a1; --c2:#10ac84; --c3:#f368e0; --c4:#5f27cd;" title="La mar"
        onclick="createSeaLevels()"></button>
      <button class="circle-btn" style="--c1:#ff6b6b; --c2:#48dbfb; --c3:#ff9f43; --c4:#341f97;" title="Night and Day"
        onclick="createNightAndDay()"></button>
      <button class="circle-btn" style="--c1:#00d2d3; --c2:#feca57; --c3:#ff6b6b; --c4:#5f27cd;"
        title="Breakfast on Tiffanys" onclick="createSunrise()"></button>
      <button class="circle-btn" onclick="createColdest()" style="--c1:#f368e0; --c2:#ff9f43; --c3:#1dd1a1; --c4:#54a0ff;"
        title="Coldest place in the world"></button>
      <button class="circle-btn" style="--c1:#5f27cd; --c2:#48dbfb; --c3:#ff6b6b; --c4:#feca57;"
        title="alertas"></button>
      <button class="circle-btn" style="--c1:#10ac84; --c2:#341f97; --c3:#ff9f43; --c4:#f368e0;"
        title="mareas"></button>
      <button class="circle-btn" style="--c1:#ff9f43; --c2:#1dd1a1; --c3:#54a0ff; --c4:#ff6b6b;"
        title="deporte"></button>
      <button class="circle-btn" style="--c1:#48dbfb; --c2:#5f27cd; --c3:#feca57; --c4:#ff9f43;"
        title="salvamento"></button>
      <button class="arrow-btn">&gt;</button>
    </div>

    <div id="cards">
    </div>
  </main>

  <my-footer></my-footer>

  <script>
    const url_temperatures = "https://api.open-meteo.com/v1/forecast?latitude=38.3452&longitude=-0.4815&hourly=temperature_2m,relative_humidity_2m,dew_point_2m,apparent_temperature,precipitation_probability,precipitation,rain,showers,snowfall,snow_depth&forecast_days=1";
    const url_capitals = "https://api.open-meteo.com/v1/forecast?latitude=40.4165,51.5085,41.8919,48.8534,52.5244,55.6759,38.7167,46.9481&longitude=-3.7026,-0.1257,12.5113,2.3488,13.4105,12.5655,-9.1333,7.4474&hourly=temperature_2m,precipitation_probability,relative_humidity_2m&forecast_days=1";
    const url_sea = "https://api.open-meteo.com/v1/forecast?latitude=38.1917&longitude=-0.5658&hourly=pressure_msl,surface_pressure,visibility,wind_speed_10m&forecast_days=1"
    const url_isDay = "https://api.open-meteo.com/v1/forecast?latitude=-30,39.4739,40.4165,-33.8678&longitude=-71,-0.3797,-3.7026,151.2073&hourly=is_day&forecast_days=1";
    const url_sunrise = "https://api.open-meteo.com/v1/forecast?latitude=34.0522,40.7143,48.8534,41.8919&longitude=-118.2437,-74.006,2.3488,12.5113&daily=sunrise&forecast_days=1";
    const url_coldest = "https://api.open-meteo.com/v1/forecast?latitude=62.0339&longitude=129.7331&current=temperature_2m,relative_humidity_2m,apparent_temperature,is_day,wind_speed_10m,wind_direction_10m,wind_gusts_10m,precipitation,rain,showers,snowfall&forecast_days=1";
    let jsonData;
    let cardRoot = document.getElementById("cards");
    let temperatureInfo, humidityInfo, precipitationInfo;
    let capitalsInfo, capitalsInfoPrecipitation, capitalsInfoHumidity;
    let seaLevels;
    let isDay;
    let sunrise;
    let coldest;

    async function getTemperatureDataFromURL() {
      await fetch(url_temperatures)
        .then(response => response.json())
        .then(data => {
          setTemperatureInfo(data)
          setHumidityInfo(data)
          setPrecipitationInfo(data)
          createWelcomeTitle();
        })
    }

    async function getCapitalsDataFromURL() {
      await fetch(url_capitals)
        .then(response => response.json())
        .then(data => {
          setCapitalsData(data)
        })
    }

    async function getSeaLevelsDataFromURL() {
      await fetch(url_sea)
        .then(response => response.json())
        .then(data => {
          setSeaLevelsData(data)
        })
    }

    async function getIsDayDataFromURL() {
      await fetch(url_isDay)
        .then(response => response.json())
        .then(data => {
          setNightAndDayData(data)
        })
    }

    async function getSunriseDataFromURL() {
      await fetch(url_sunrise)
        .then(response => response.json())
        .then(data => {
          setSunriseData(data)
        })
    }

    async function getColdestDataFromURL() {
      await fetch(url_coldest)
        .then(response => response.json())
        .then(data => {
          setColdestData(data)
        })
    }

    function setTemperatureInfo(data) {
      temperatureInfo = {
        temperature_9: data.hourly.temperature_2m[10],
        temperature_12: data.hourly.temperature_2m[13],
        temperature_15: data.hourly.temperature_2m[16],
        temperature_17: data.hourly.temperature_2m[18],
        temperature_20: data.hourly.temperature_2m[21],
        temperature_22: data.hourly.temperature_2m[23]
      }
    }

    function setHumidityInfo(data) {
      humidityInfo = {
        humidity_9: data.hourly.relative_humidity_2m[10],
        humidity_12: data.hourly.relative_humidity_2m[13],
        humidity_15: data.hourly.relative_humidity_2m[16],
        humidity_17: data.hourly.relative_humidity_2m[18],
        humidity_20: data.hourly.relative_humidity_2m[21],
        humidity_22: data.hourly.relative_humidity_2m[23]
      }
    }

    function setPrecipitationInfo(data) {
      precipitationInfo = {
        precipitation_9: data.hourly.precipitation_probability[10],
        precipitation_12: data.hourly.precipitation_probability[13],
        precipitation_15: data.hourly.precipitation_probability[16],
        precipitation_17: data.hourly.precipitation_probability[18],
        precipitation_20: data.hourly.precipitation_probability[21],
        precipitation_22: data.hourly.precipitation_probability[23]
      }
    }

    function setCapitalsData(data) {
      capitalsInfo = {
        capitalMadrid: data[0].hourly.temperature_2m[13],
        capitalLondon: data[1].hourly.temperature_2m[13],
        capitalRome: data[2].hourly.temperature_2m[13],
        capitalParis: data[3].hourly.temperature_2m[13],
        capitalBerlin: data[4].hourly.temperature_2m[13],
        capitalCopenhagen: data[5].hourly.temperature_2m[13],
        capitalLisboa: data[6].hourly.temperature_2m[13],
        capitalSuiza: data[7].hourly.temperature_2m[13]
      }
      capitalsInfoPrecipitation = {
        capitalMadrid: data[0].hourly.precipitation_probability[13],
        capitalLondon: data[1].hourly.precipitation_probability[13],
        capitalRome: data[2].hourly.precipitation_probability[13],
        capitalParis: data[3].hourly.precipitation_probability[13],
        capitalBerlin: data[4].hourly.precipitation_probability[13],
        capitalCopenhagen: data[5].hourly.precipitation_probability[13],
        capitalLisboa: data[6].hourly.precipitation_probability[13],
        capitalSuiza: data[7].hourly.precipitation_probability[13]
      }
      capitalsInfoHumidity = {
        capitalMadrid: data[0].hourly.relative_humidity_2m[13],
        capitalLondon: data[1].hourly.relative_humidity_2m[13],
        capitalRome: data[2].hourly.relative_humidity_2m[13],
        capitalParis: data[3].hourly.relative_humidity_2m[13],
        capitalBerlin: data[4].hourly.relative_humidity_2m[13],
        capitalCopenhagen: data[5].hourly.relative_humidity_2m[13],
        capitalLisboa: data[6].hourly.relative_humidity_2m[13],
        capitalSuiza: data[7].hourly.relative_humidity_2m[13]
      }
    }

    function setSeaLevelsData(data) {
      seaLevels = {
        seaPressure: data.hourly.pressure_msl[13],
        surfacePressure: data.hourly.surface_pressure[13],
        visibility: data.hourly.visibility[13],
        windSpeed: data.hourly.wind_speed_10m[13]
      }
    }

    function setNightAndDayData(data) {
      let now = new Date();
      let hour = now.getHours();
      nightAndDay = {
        chile: data[0].hourly.is_day[hour],
        valencia: data[1].hourly.is_day[hour],
        madrid: data[2].hourly.is_day[hour],
        sydney: data[3].hourly.is_day[hour]
      }
    }

    function setSunriseData(data) {
      sunrise = {
        losAngeles: data[0].daily.sunrise[0],
        nuevaYork: data[1].daily.sunrise[0],
        paris: data[2].daily.sunrise[0],
        rome: data[3].daily.sunrise[0]
      }
    }

    function setColdestData(data) {
      coldest = {
        temperature: data.current.temperature_2m,
        humidity: data.current.relative_humidity_2m,
        aparentTemperature: data.current.apparent_temperature,
        day: data.current.is_day,
        windSpeed: data.current.wind_speed_10m,
        windDirection: data.current.wind_direction_10m,
        windGusts: data.current.wind_gusts_10m,
        precipitation: data.current.precipitation,
        rain: data.current.rain,
        showers: data.current.showers,
        snowfall: data.current.snowfall
      }
    }

    function createCard(cardTitle, cardDescription, jsonData) {
      let element = document.createElement("div");
      let title = document.createElement("h2");
      let value = document.createElement("div");
      let description = document.createElement("div");


      element.classList.add("card");
      value.classList.add("value");
      description.classList.add("info");
      /*
      let image = document.createElement("img");
      let image2 = document.createElement("img");
      let border = document.createElement("img");
      let border2 = document.createElement("img");
      let layer = document.createElement("div");
      let block = document.createElement("div");
      let block2 = document.createElement("div");

      image.classList.add("gif");
      image2.classList.add("gif");
      border.classList.add("border");
      border2.classList.add("border");
      layer.classList.add("layer");
      block.classList.add("block");
      block2.classList.add("block");

      */
      title.textContent = cardTitle;
      value.textContent = jsonData;
      description.textContent = cardDescription;
      //image.src = "../media/gifs/rain.gif"
      //image2.src = "../media/gifs/rain.gif"
      //block.append(image);
      //block.append(border);
      //block2.append(image2);
      //block2.append(border2);
      //block.append(image2);
      //layer.append(border);

      //layer.append(block);
      //layer.append(block2);
      //element.append(layer);
      element.append(description);
      element.append(value);
      element.append(title);

      cardRoot.append(element);
    }

    function createTuristCards() {
      resetCards();
      createCard("Temperature C°", "Temperature at 10AM", temperatureInfo.temperature_9);
      createCard("Temperature C°", "Temperature at 13PM", temperatureInfo.temperature_12);
      createCard("Temperature C°", "Temperature at 16PM", temperatureInfo.temperature_15);
      createCard("Temperature C°", "Temperature at 18PM", temperatureInfo.temperature_17);
      createCard("Temperature C°", "Temperature at 21PM", temperatureInfo.temperature_20);
      createCard("Humidity %", "Humidity at 22PM", humidityInfo.humidity_22);

      let card = document.getElementsByClassName("card");
      let centerX = window.innerWidth / 2;
      let centerY = window.innerHeight / 2;
      let distanceToMouseX, distanceToMouseY;
      document.addEventListener('mousemove', event => {
        distanceToMouseX = (event.clientX - centerX) / 20;
        distanceToMouseY = (event.clientY - centerY) / 20;
        Array.from(card).forEach(element => element.style.transform = `perspective(1000px) rotateY(${distanceToMouseX}deg) rotateX(${distanceToMouseY}deg)`);
      });
    }

    function createCapitalsCards() {
      resetCards();
      createCard("Temperature C°", "Madrid, Spain", capitalsInfo.capitalMadrid);
      createCard("Rain Probability %", "Madrid, Spain", capitalsInfoPrecipitation.capitalMadrid);
      createCard("Humidity %", "Madrid, Spain", capitalsInfoHumidity.capitalMadrid);
      createCard("Rain Probability %", "London, UK", capitalsInfoPrecipitation.capitalLondon);
      createCard("Humidity %", "London, UK", capitalsInfoHumidity.capitalLondon);
      createCard("Temperature C°", "Rome, Italy", capitalsInfo.capitalRome);
      createCard("Humidity %", "Rome, Italy", capitalsInfoHumidity.capitalRome);
      createCard("Temperature C°", "Paris, France", capitalsInfo.capitalParis);
      createCard("Rain Probability %", "Paris, France", capitalsInfoPrecipitation.capitalParis);
      createCard("Rain Probability %", "Copenhagen, Denmark", capitalsInfoPrecipitation.capitalCopenhagen);
      createCard("Humidity %", "Copenhagen, Denmark", capitalsInfoHumidity.capitalCopenhagen);
      createCard("Temperature C°", "Bern, Schweiz", capitalsInfo.capitalSuiza);
      createCard("Rain Probability %", "Bern, Schweiz", capitalsInfoPrecipitation.capitalSuiza);
      createCard("Temperature C°", "Lisbon, Portuguese", capitalsInfo.capitalLisboa);
      createCard("Rain Probability %", "Lisbon, Portuguese", capitalsInfoPrecipitation.capitalLisboa);
      createCard("Humidity %", "Lisbon, Portuguese", capitalsInfoHumidity.capitalLisboa);
    }

    function createSeaLevels() {
      resetCards();
      createCard("hPA", "Sea Pressure", seaLevels.seaPressure);
      createCard("hPA", "Sea surface Pressure", seaLevels.surfacePressure);
      createCard("m", "Visibility", seaLevels.visibility);
      createCard("km/h", "Wind Speed at 10m", seaLevels.windSpeed);
    }

    function createNightAndDay() {
      resetCards();
      createCard("Chile", "Chile is night", nightAndDay.chile);
      createCard("Valencia", "Valencia is bright", nightAndDay.valencia);
      createCard("Madrid", "Madrid is bright", nightAndDay.madrid);
      createCard("Sydney", "Sydney is night", nightAndDay.sydney);
    }

    function createSunrise() {
      resetCards();
      createCard("Hollywood", "Los Angeles have breakfast when you are", sunrise.losAngeles.slice(-4));
      createCard("Atlantic City", "Nueva York have breakfast when you are", sunrise.nuevaYork.slice(-4));
      createCard("Rio Sena", "Paris have breakfast when you are", sunrise.paris.slice(-4));
      createCard("Cinecitta", "Rome have breakfast when you are", sunrise.rome.slice(-4));
    }

    function createColdest() {
      resetCards();
      createCard("Temperature C°", "Yakutsk temperature", coldest.temperature);
      createCard("Humidity %", "Yakutsk humidty", coldest.humidity);
      createCard("Termic Sensation C°", "Yakutsk termic sensation", coldest.aparentTemperature);
      createCard("is daytime?", "Yakutsk daytime", coldest.day);
      createCard("Wind Speed km/h", "Yakutsk wind speed", coldest.windSpeed);
      createCard("Wind Direction °", "Yakutsk wind direction", coldest.windDirection);
      createCard("Wind Gusts km/h", "Yakutsk wind gusts", coldest.windGusts);
      createCard("Precipitation mm", "Yakutsk precipitation", coldest.precipitation);
      createCard("Rain mm", "Yakutsk rain", coldest.rain);
      createCard("Showers mm", "Yakutsk showers", coldest.showers);
      createCard("Snowfall mm", "Yakutsk snowfall", coldest.snowfall);

    }


    function createWelcomeTitle() {
      let welcome = document.createElement("h3");
      welcome.textContent = "Select an Ecosystem";
      cardRoot.append(welcome);
    }
    function resetCards() {
      cardRoot.textContent = "";
    }

    getTemperatureDataFromURL();
    getCapitalsDataFromURL();
    getSeaLevelsDataFromURL();
    getIsDayDataFromURL();
    getSunriseDataFromURL();
    getColdestDataFromURL();

  </script>
</body>

</html>